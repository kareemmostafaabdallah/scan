name: God-Tier Recon 

on:
  workflow_dispatch:
    inputs:
      target:
        description: 'Domain or IP/CIDR'
        required: true
        default: 'tesla.com'

jobs:
  god-recon:
    runs-on: ubuntu-latest
    timeout-minutes: 240

    steps:
      - name: Checkout
        uses: actions/checkout@v4
        continue-on-error: true

      - name: Install Ultimate Tools 2025 (ØµÙØ± Ø£Ø®Ø·Ø§Ø¡)
        run: |
          # Ø£Ù‚ÙˆÙ‰ 3 Ø£Ø¯ÙˆØ§Øª ÙÙŠ 2025 (ÙƒÙ„ ÙˆØ§Ø­Ø¯Ø© Ø¨ØªØ¬ÙŠØ¨ Ø§Ù„Ù„ÙŠ Ø§Ù„Ø¨Ø§Ù‚ÙŠ Ù…Ø§Ø¨ÙŠØ¬ÙŠØ¨ÙˆØ´)
          curl -sSfL https://raw.githubusercontent.com/projectdiscovery/nuclei/master/install.sh | sh
          curl -sSfL https://install.projectdiscovery.io | bash

          # katana + chaos + dnsx + httpx (Ø£Ø­Ø¯Ø« Ø¥ØµØ¯Ø§Ø±Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§)
          bash <(curl -sSfL https://install.projectdiscovery.io) -install katana chaos dnsx httpx

          # bbscope (Ø¨Ø±Ø¶Ùˆ Ù…Ù† PD â€“ Ù„Ù„Ù€ bruteforce Ø§Ù„Ø°ÙƒÙŠ)
          go install github.com/projectdiscovery/bbscope/cmd/bbscope@latest

          echo "$HOME/.local/bin" >> $GITHUB_PATH
          echo "$HOME/go/bin" >> $GITHUB_PATH

      - name: Start Notification
        if: env.DISCORD_WEBHOOK
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          curl -X POST "$DISCORD_WEBHOOK" -d '{
            "content": "**God-Tier Recon Ø¨Ø¯Ø£ Ø¹Ù„Ù‰** `'${{ inputs.target }}'`\nØ§Ø³ØªÙ†ÙˆØ§ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù„ÙŠ Ù‡ØªÙƒØ³Ø± Ø§Ù„Ø¯Ù†ÙŠØ§ ğŸ”¥"
          }'

      - name: Chaos + Subfinder API Keys (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„ÙƒÙ† ÙŠØ¬ÙŠØ¨ 10Ã— Ø£ÙƒØªØ±)
        run: |
          mkdir -p ~/.config/subfinder
          echo "chaos: ${{ secrets.CHAOS_KEY }}" >> ~/.config/subfinder/provider-config.yaml
          echo "binaryedge: ${{ secrets.BINARYEDGE }}" >> ~/.config/subfinder/provider-config.yaml
          echo "shodan: ${{ secrets.SHODAN }}" >> ~/.config/subfinder/provider-config.yaml

      - name: Ultimate Subdomain Discovery
        run: |
          TARGET="${{ inputs.target }}"

          # 1. Chaos (Ø£Ù‚ÙˆÙ‰ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø§Ù„ÙŠÙ‹Ø§)
          chaos -d $TARGET -silent -o chaos.txt

          # 2. Katana (crawling + JS + APIs = Ø¢Ù„Ø§Ù Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø² Ø§Ù„Ø®ÙÙŠØ©)
          echo $TARGET | katana -silent -o katana.txt

          # 3. bbscope (brute (Ø¨Ø±ÙŠÙˆØª ÙÙˆØ±Ø³ Ø°ÙƒÙŠ Ø¨Ù€ 100k wordlist)
          bbscope -t $TARGET -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-20000.txt -o bbscope.txt

          # 4. crt.sh + riddler + bufferover
          curl -s "https://crt.sh/?q=%25.$TARGET&output=json" | jq -r '.[].name_value' | sed 's/^*.//' | sort -u > crt.txt
          curl -s "https://dns.bufferover.run/dns?q=$TARGET" | jq -r '.FDNS_A[]?|.split(",")[1]' 2>/dev/null | sort -u >> all.txt
          curl -s "https://riddler.io/search/exportcsv?q=pld:$TARGET" | grep -oE "[a-zA-Z0-9._-]+\.$TARGET" | sort -u >> all.txt

          cat chaos.txt katana.txt bbscope.txt crt.txt all.txt 2>/dev/null | sort -u > raw-subdomains.txt

          # ØªÙ†Ø¸ÙŠÙ Ùˆresolve
          dnsx -l raw-subdomains.txt -silent -resp-only | httpx -silent -title -tech-detect -status-code -o alive.txt

          TOTAL=$(wc -l < raw-subdomains.txt)
          ALIVE=$(wc -l < alive.txt)
          echo "TOTAL=$TOTAL" >> $GITHUB_ENV
          echo "ALIVE=$ALIVE" >> $GITHUB_ENV

      - name: Nuclei Scan (High-Impact Only â€“ <40 Ø¯Ù‚ÙŠÙ‚Ø©)
        run: |
          nuclei -l alive.txt -t cves/ -t exposures/ -t misconfiguration/ -t default-logins/ -severity critical,high,medium -c 80 -rl 150 -o nuclei.txt -jsonl

      - name: Send Everything to Discord
        if: env.DISCORD_WEBHOOK
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          curl -X POST "$DISCORD_WEBHOOK" -d "{
            \"content\": \"**God-Tier Recon Ø®Ù„Ù‘Øµ ÙŠØ§ Ù…Ø¹Ù„Ù…!**\n**Target:** ${{ inputs.target }}\n**Ø§Ù„ÙƒÙ„:** $TOTAL\n**Ø§Ù„Ø¹Ø§ÙŠØ´ÙŠÙ†:** $ALIVE\n**Vulns:** $(wc -l < nuclei.txt)\"
          }"
          curl -F "file=@raw-subdomains.txt" "$DISCORD_WEBHOOK"
          curl -F "file=@alive.txt" "$DISCORD_WEBHOOK"
          [ -s nuclei.txt ] && curl -F "file=@nuclei.txt" "$DISCORD_WEBHOOK" || echo "Clean!"

      - name: Upload Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: GOD-RECON-${{ inputs.target }}
          path: |
            raw-subdomains.txt
            alive.txt
            nuclei.txt

      - name: Final Message
        run: |
          echo "ØªÙ… ÙŠØ§ ÙˆØ­Ø´â€¦ ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø¹Ù†Ø¯Ùƒ Ø¯Ù„ÙˆÙ‚ØªÙŠ"
